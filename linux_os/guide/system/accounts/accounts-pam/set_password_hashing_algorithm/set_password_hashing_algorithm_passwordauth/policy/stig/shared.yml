srg_requirement: |-
    {{{ full_name }}} pam_unix.so module must be configured in the password-auth file to use a FIPS 140-3 approved cryptographic hashing algorithm for system authentication.

fixtext: |-
    Configure {{{ full_name }}} to use a FIPS 140-3 approved cryptographic hashing algorithm for system authentication.

    Edit/modify the following line in the "/etc/pam.d/password-auth" file to include the sha512 option for pam_unix.so:

    password sufficient pam_unix.so sha512

checktext: |-
    Verify that the pam_unix.so module is configured to use sha512 in /etc/pam.d/password-auth with the following command:

    $ grep "^password.*pam_unix.so.*sha512" /etc/pam.d/password-auth

    password sufficient pam_unix.so sha512

    If "sha512" is missing, or the line is commented out, this is a finding.

