documentation_complete: true


title: Ensure that /etc/at.deny exists

description: |-
    The file <tt>/etc/at.deny</tt> should exist and should be used instead
    of <tt>/etc/at.deny</tt>.

rationale: |-
    On many systems, only the system administrator is authorized to schedule at jobs.
    Using the at.deny file to control who can run at jobs enforces this policy. It is easier
    to manage an deny list than a deny list. In a deny list, you could potentially add a user
    ID to the system and forget to add it to the deny files.

severity: medium

ocil_clause: 'the file /etc/at.deny does not exist'

ocil: |-
    The file <tt>/etc/at.deny</tt> should exist.
    This can be checked by running the following command:
    <pre>
    stat /etc/at.deny
    </pre>
    and the output should list the file.

template:
    name: file_existence
    vars:
        filepath: /etc/at.deny
        exists: true
        fileuid: "0"
        filemode: "0640"
